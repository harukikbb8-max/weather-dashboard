/**
 * globals.css
 * ───────────
 * 責任: アプリケーション全体のテーマ・基盤スタイル定義
 *
 * 設計意図:
 *  - Tailwind CSS v4 の @import による統合
 *  - Liquid Glass デザインシステムのグローバルユーティリティクラス定義
 *  - CSS カスタムプロパティでテーマ値を一元管理
 *  - コンポーネント個別のスタイルは Tailwind ユーティリティクラスで記述し、
 *    ここには「サイト全体で繰り返し使うパターン」のみ配置
 */

@import "tailwindcss";

/* ============================================================
   テーマ変数
   ============================================================ */

:root {
  --glass-bg: rgba(255, 255, 255, 0.07);
  --glass-border: rgba(255, 255, 255, 0.14);
  --glass-blur: 14px;
}

/* ============================================================
   ベーススタイル
   ============================================================ */

body {
  /* 背景は SkyBackground コンポーネントが動的に描画するため、
     ここでは透明（デフォルト色はフォールバック用） */
  background: #0a0e1a;
  color: #e2e8f0;
  min-height: 100vh;
  overflow-y: scroll;
}

/* ============================================================
   Liquid Glass ユーティリティ
   ============================================================

   .glass-card:
   macOS Liquid Glass のガラスモーフィズムを再現するクラス。
   backdrop-filter で背景をぼかし、半透明の背景色と微細なボーダーで
   「すりガラス」の質感を表現する。

   使用箇所: Header, 各セレクタ, チャートカード, 現在天気カード等
   → アプリ全体でビジュアルの一貫性を保証する
*/
.glass-card {
  background: var(--glass-bg);
  border: 1px solid var(--glass-border);
  border-radius: 1rem;
  backdrop-filter: blur(var(--glass-blur));
  -webkit-backdrop-filter: blur(var(--glass-blur));
  /* 上辺に微細なハイライトを追加し、光源を示唆 */
  box-shadow:
    inset 0 1px 0 0 rgba(255, 255, 255, 0.06),
    0 4px 24px -1px rgba(0, 0, 0, 0.2);
  transition: box-shadow 0.3s ease, border-color 0.3s ease;
}

.glass-card:hover {
  border-color: rgba(255, 255, 255, 0.2);
  box-shadow:
    inset 0 1px 0 0 rgba(255, 255, 255, 0.1),
    0 8px 32px -4px rgba(0, 0, 0, 0.3);
}

/* ============================================================
   Recharts カスタムスタイル
   ============================================================

   Recharts はインラインスタイルを多用するため、
   一部のスタイル上書きにはグローバルCSSが必要
*/

/* ツールチップの背景を Liquid Glass に */
.recharts-tooltip-wrapper {
  filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.3));
}

/* レジェンドのテキスト色 */
.recharts-legend-item-text {
  color: rgba(255, 255, 255, 0.6) !important;
}

/* ============================================================
   スクロールバーカスタマイズ
   ============================================================ */

::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.2);
}

/* ============================================================
   セレクトボックスのoption要素
   ============================================================
   <option> はOSネイティブ描画のため、ダーク背景を明示
*/

select option {
  background: #1a1f2e;
  color: #e2e8f0;
}

/* ============================================================
   アニメーション
   ============================================================ */

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-in {
  animation: fadeIn 0.4s ease-out;
}

/* ============================================================
   空背景エフェクト
   ============================================================

   SkyBackground コンポーネントが使用するCSS-onlyアニメーション。
   Canvas/JSアニメーション不使用 → メインスレッドをブロックしない。
   GPU合成レイヤーで描画されるため60fps維持可能。
*/

/* --- 星（夜間・晴天用） ---
   radial-gradient で微細なドットを散布し、twinkle で明滅させる。
   3つのレイヤーを重ねてランダム感を演出。 */
.sky-stars {
  background:
    radial-gradient(1px 1px at 10% 15%, rgba(255,255,255,0.8), transparent),
    radial-gradient(1px 1px at 25% 35%, rgba(255,255,255,0.6), transparent),
    radial-gradient(1px 1px at 40% 10%, rgba(255,255,255,0.7), transparent),
    radial-gradient(1px 1px at 55% 45%, rgba(255,255,255,0.5), transparent),
    radial-gradient(1px 1px at 70% 20%, rgba(255,255,255,0.8), transparent),
    radial-gradient(1px 1px at 85% 40%, rgba(255,255,255,0.6), transparent),
    radial-gradient(1px 1px at 15% 55%, rgba(255,255,255,0.4), transparent),
    radial-gradient(1px 1px at 35% 70%, rgba(255,255,255,0.7), transparent),
    radial-gradient(1px 1px at 60% 65%, rgba(255,255,255,0.5), transparent),
    radial-gradient(1px 1px at 80% 75%, rgba(255,255,255,0.6), transparent),
    radial-gradient(1px 1px at 90% 60%, rgba(255,255,255,0.4), transparent),
    radial-gradient(1px 1px at 50% 80%, rgba(255,255,255,0.7), transparent),
    radial-gradient(1.5px 1.5px at 20% 85%, rgba(200,220,255,0.9), transparent),
    radial-gradient(1.5px 1.5px at 75% 90%, rgba(200,220,255,0.8), transparent);
  background-size: 200px 200px;
  animation: twinkle 4s ease-in-out infinite alternate;
}

@keyframes twinkle {
  0% { opacity: inherit; }
  50% { opacity: calc(0.6 * var(--tw-opacity, 1)); }
  100% { opacity: inherit; }
}

/* --- 雨（3層構成） ---
   手前・中間・奥の3レイヤーで奥行き感のある雨を表現。
   各雨粒を個別の linear-gradient で配置し、ランダム感を演出。
   repeating-linear-gradient の均等ストライプを避け、自然な降雨に見せる。
   opacity は SkyBackground 側で制御し、コンテンツを遮らない。 */

/* 手前の雨: 太め・速い・やや斜め */
.sky-rain-layer-1 {
  background:
    linear-gradient(175deg, transparent 0%, transparent 45%, rgba(180,210,255,0.25) 45%, rgba(180,210,255,0.08) 55%, transparent 55%) 8% 0 / 60px 90px,
    linear-gradient(172deg, transparent 0%, transparent 42%, rgba(190,215,255,0.22) 42%, rgba(190,215,255,0.06) 54%, transparent 54%) 25% 30px / 55px 85px,
    linear-gradient(176deg, transparent 0%, transparent 44%, rgba(175,205,250,0.2) 44%, rgba(175,205,250,0.07) 53%, transparent 53%) 42% 10px / 65px 95px,
    linear-gradient(173deg, transparent 0%, transparent 46%, rgba(185,212,255,0.23) 46%, rgba(185,212,255,0.06) 55%, transparent 55%) 60% 50px / 50px 80px,
    linear-gradient(177deg, transparent 0%, transparent 43%, rgba(180,210,255,0.18) 43%, rgba(180,210,255,0.05) 54%, transparent 54%) 78% 20px / 58px 88px,
    linear-gradient(174deg, transparent 0%, transparent 45%, rgba(190,218,255,0.21) 45%, rgba(190,218,255,0.07) 56%, transparent 56%) 93% 60px / 62px 92px;
  animation: rain-fast 0.5s linear infinite;
}

/* 中間の雨: やや細め・中速 */
.sky-rain-layer-2 {
  background:
    linear-gradient(176deg, transparent 0%, transparent 46%, rgba(160,195,240,0.18) 46%, rgba(160,195,240,0.05) 53%, transparent 53%) 5% 15px / 70px 100px,
    linear-gradient(174deg, transparent 0%, transparent 44%, rgba(170,200,240,0.15) 44%, rgba(170,200,240,0.04) 52%, transparent 52%) 20% 45px / 65px 95px,
    linear-gradient(178deg, transparent 0%, transparent 47%, rgba(155,190,235,0.16) 47%, rgba(155,190,235,0.05) 54%, transparent 54%) 38% 5px / 72px 105px,
    linear-gradient(175deg, transparent 0%, transparent 45%, rgba(165,198,240,0.14) 45%, rgba(165,198,240,0.04) 53%, transparent 53%) 55% 35px / 60px 90px,
    linear-gradient(177deg, transparent 0%, transparent 43%, rgba(160,195,240,0.17) 43%, rgba(160,195,240,0.05) 52%, transparent 52%) 72% 55px / 68px 98px,
    linear-gradient(173deg, transparent 0%, transparent 46%, rgba(170,202,242,0.13) 46%, rgba(170,202,242,0.04) 54%, transparent 54%) 88% 25px / 75px 108px;
  animation: rain-mid 0.7s linear infinite;
}

/* 奥の雨: 細く・遅い・ほぼ垂直 */
.sky-rain-layer-3 {
  background:
    linear-gradient(179deg, transparent 0%, transparent 47%, rgba(140,175,220,0.1) 47%, rgba(140,175,220,0.03) 52%, transparent 52%) 12% 10px / 80px 120px,
    linear-gradient(178deg, transparent 0%, transparent 46%, rgba(145,178,222,0.09) 46%, rgba(145,178,222,0.02) 51%, transparent 51%) 30% 50px / 85px 115px,
    linear-gradient(180deg, transparent 0%, transparent 48%, rgba(138,172,218,0.08) 48%, rgba(138,172,218,0.02) 52%, transparent 52%) 48% 30px / 78px 125px,
    linear-gradient(179deg, transparent 0%, transparent 47%, rgba(142,176,220,0.1) 47%, rgba(142,176,220,0.03) 53%, transparent 53%) 65% 70px / 82px 118px,
    linear-gradient(177deg, transparent 0%, transparent 46%, rgba(140,175,220,0.07) 46%, rgba(140,175,220,0.02) 51%, transparent 51%) 82% 40px / 90px 130px;
  animation: rain-slow 0.9s linear infinite;
}

@keyframes rain-fast {
  from { background-position-y: 0; }
  to { background-position-y: 90px; }
}
@keyframes rain-mid {
  from { background-position-y: 0; }
  to { background-position-y: 100px; }
}
@keyframes rain-slow {
  from { background-position-y: 0; }
  to { background-position-y: 120px; }
}

/* --- 雪（2層構成） ---
   大粒と小粒を別レイヤーにし、落下速度と揺れ幅を変えて
   自然な降雪を表現。 */

/* 大粒: ゆっくり、大きく揺れる */
.sky-snow-layer-1 {
  background:
    radial-gradient(3px 3px at 10% 20%, rgba(255,255,255,0.6), transparent),
    radial-gradient(3.5px 3.5px at 30% 50%, rgba(255,255,255,0.5), transparent),
    radial-gradient(3px 3px at 55% 15%, rgba(255,255,255,0.55), transparent),
    radial-gradient(4px 4px at 75% 65%, rgba(255,255,255,0.4), transparent),
    radial-gradient(3px 3px at 90% 35%, rgba(255,255,255,0.5), transparent),
    radial-gradient(3.5px 3.5px at 45% 80%, rgba(255,255,255,0.45), transparent);
  background-size: 180px 180px;
  animation: snow-large 5s linear infinite;
}

/* 小粒: 速め、細かく揺れる */
.sky-snow-layer-2 {
  background:
    radial-gradient(1.5px 1.5px at 15% 25%, rgba(255,255,255,0.5), transparent),
    radial-gradient(2px 2px at 35% 55%, rgba(255,255,255,0.4), transparent),
    radial-gradient(1.5px 1.5px at 60% 10%, rgba(255,255,255,0.45), transparent),
    radial-gradient(2px 2px at 80% 70%, rgba(255,255,255,0.35), transparent),
    radial-gradient(1.5px 1.5px at 25% 85%, rgba(255,255,255,0.4), transparent),
    radial-gradient(2px 2px at 70% 40%, rgba(255,255,255,0.5), transparent),
    radial-gradient(1.5px 1.5px at 50% 60%, rgba(255,255,255,0.35), transparent),
    radial-gradient(2px 2px at 95% 15%, rgba(255,255,255,0.4), transparent);
  background-size: 140px 140px;
  animation: snow-small 3.5s linear infinite;
}

@keyframes snow-large {
  from { background-position: 0 0; }
  to { background-position: 40px 180px; }
}
@keyframes snow-small {
  from { background-position: 0 0; }
  to { background-position: -20px 140px; }
}
